{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "30d55549-c9ec-4ab4-84ca-698ca3cd4d73",
   "metadata": {},
   "outputs": [],
   "source": [
    "import json\n",
    "import pandas as pd\n",
    "import re"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "3a97dc99-f276-411b-af9c-38f4c5ac4dbd",
   "metadata": {},
   "outputs": [],
   "source": [
    "def load(name):\n",
    "    with open(f\".\\\\annotations\\jsons\\{name}.json\",\"r\") as f:\n",
    "        return json.load(f)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "85a1c62e-5df2-4a08-ab03-a7175d086bdf",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Rows skipped:  20\n"
     ]
    }
   ],
   "source": [
    "data_list =[]\n",
    "skips = 0\n",
    "names = [\"johan\",\"chris\",\"karl\",\"alan\"]\n",
    "for name in names:\n",
    "    data = load(name)\n",
    "    for annotation in data:\n",
    "        filename = annotation[\"file_upload\"].split(\"-\")[1]\n",
    "        match = re.match(r\"(api_)?(.*)_\\d+.jpg\",filename)\n",
    "        groups = match.groups()\n",
    "        if groups[0]:\n",
    "            api = True\n",
    "        else:\n",
    "            api = False\n",
    "        profession = groups[1]\n",
    "        try:\n",
    "            annotation[\"annotations\"][0][\"result\"][0][\"value\"][\"choices\"][0]\n",
    "        except:\n",
    "            skips += 1\n",
    "            continue\n",
    "        data_list.append([filename,\n",
    "                          api,\n",
    "                          profession,\n",
    "                          name,\n",
    "                          annotation[\"annotations\"][0][\"result\"][0][\"value\"][\"choices\"][0]])\n",
    "print(\"Rows skipped: \",skips)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "a006b838-74e3-4b17-af7b-9e164f85b84a",
   "metadata": {},
   "outputs": [],
   "source": [
    "# data[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "7fd3c081-e9fb-4290-8f0e-1cf49f3d5124",
   "metadata": {},
   "outputs": [],
   "source": [
    "df = pd.DataFrame(data_list,columns=[\"filename\",\"api\",\"profession\",\"annotator\",\"annotation\"])\n",
    "df.to_csv(\"annotation.csv\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 83,
   "id": "3d8d3a3a-c704-4927-9acf-ba3ff314f278",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>filename</th>\n",
       "      <th>api</th>\n",
       "      <th>profession</th>\n",
       "      <th>annotator</th>\n",
       "      <th>annotation</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>professor_100.jpg</td>\n",
       "      <td>False</td>\n",
       "      <td>professor</td>\n",
       "      <td>johan</td>\n",
       "      <td>Male</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>api_carpenter_75.jpg</td>\n",
       "      <td>True</td>\n",
       "      <td>carpenter</td>\n",
       "      <td>johan</td>\n",
       "      <td>Male</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>secretary_173.jpg</td>\n",
       "      <td>False</td>\n",
       "      <td>secretary</td>\n",
       "      <td>johan</td>\n",
       "      <td>Male</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>api_professor_34.jpg</td>\n",
       "      <td>True</td>\n",
       "      <td>professor</td>\n",
       "      <td>johan</td>\n",
       "      <td>Male</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>electrician_99.jpg</td>\n",
       "      <td>False</td>\n",
       "      <td>electrician</td>\n",
       "      <td>johan</td>\n",
       "      <td>Male</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7139</th>\n",
       "      <td>api_electrician_30.jpg</td>\n",
       "      <td>True</td>\n",
       "      <td>electrician</td>\n",
       "      <td>chris</td>\n",
       "      <td>Male</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7140</th>\n",
       "      <td>api_software_developer_69.jpg</td>\n",
       "      <td>True</td>\n",
       "      <td>software_developer</td>\n",
       "      <td>chris</td>\n",
       "      <td>Male</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7141</th>\n",
       "      <td>api_carpenter_58.jpg</td>\n",
       "      <td>True</td>\n",
       "      <td>carpenter</td>\n",
       "      <td>chris</td>\n",
       "      <td>Male</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7142</th>\n",
       "      <td>maid_28.jpg</td>\n",
       "      <td>False</td>\n",
       "      <td>maid</td>\n",
       "      <td>chris</td>\n",
       "      <td>Male</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7143</th>\n",
       "      <td>api_artist_53.jpg</td>\n",
       "      <td>True</td>\n",
       "      <td>artist</td>\n",
       "      <td>chris</td>\n",
       "      <td>Male</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>7144 rows Ã— 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                           filename    api          profession annotator  \\\n",
       "0                 professor_100.jpg  False           professor     johan   \n",
       "1              api_carpenter_75.jpg   True           carpenter     johan   \n",
       "2                 secretary_173.jpg  False           secretary     johan   \n",
       "3              api_professor_34.jpg   True           professor     johan   \n",
       "4                electrician_99.jpg  False         electrician     johan   \n",
       "...                             ...    ...                 ...       ...   \n",
       "7139         api_electrician_30.jpg   True         electrician     chris   \n",
       "7140  api_software_developer_69.jpg   True  software_developer     chris   \n",
       "7141           api_carpenter_58.jpg   True           carpenter     chris   \n",
       "7142                    maid_28.jpg  False                maid     chris   \n",
       "7143              api_artist_53.jpg   True              artist     chris   \n",
       "\n",
       "     annotation  \n",
       "0          Male  \n",
       "1          Male  \n",
       "2          Male  \n",
       "3          Male  \n",
       "4          Male  \n",
       "...         ...  \n",
       "7139       Male  \n",
       "7140       Male  \n",
       "7141       Male  \n",
       "7142       Male  \n",
       "7143       Male  \n",
       "\n",
       "[7144 rows x 5 columns]"
      ]
     },
     "execution_count": 83,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1cfe1e82-cc4c-49ed-b259-6c0fac525df0",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.11"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
